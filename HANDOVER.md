# 🔄 引き継ぎ文書 - リフォーム見積・会計 Pro

## 📋 プロジェクト概要

**アプリ名**: リフォーム見積・会計 Pro（将来的には「ボイス会計 Pro」として展開予定）
**現在のバージョン**: v0.91
**開発者**: アキヤさん + Claude（クロちゃん）
**プロジェクト**: COCOMI CORE / COCOMIOS Project

---

## 🎯 ビジョン・目標

### 最終目標
**Google Play Store で公開して、大手会計ソフト（freee、マネーフォワード、弥生）を出し抜く！**

### 差別化ポイント
1. **音声入力をメイン機能に** - 「声だけで仕事が終わる」
2. **AIレシート読取** - 写真撮るだけで経費入力
3. **シンプルで使いやすい** - 大手は機能が多すぎて複雑
4. **低価格** - 月額500〜980円を想定
5. **汎用的** - 建設業だけでなく、美容室・ネイルサロン・飲食店など業種を問わない

### コンセプト
```
「打つな、話せ。」
「声だけで、確定申告。」
```

---

## 📁 現在のファイル構成

```
reform-app/
├── index.html          (313KB) - メインHTML
├── app.js              (256KB) - アプリロジック
├── products.js         (15KB)  - 商品データベース（175件）
├── styles.css          (32KB)  - スタイル
├── manifest.json       (2KB)   - PWA設定 ⭐NEW
├── sw.js               (3KB)   - Service Worker ⭐NEW
├── privacy-policy.html (6KB)   - プライバシーポリシー ⭐NEW
└── icons/              - アプリアイコン用フォルダ（空）
```

---

## ✅ 実装済み機能

### 1. レシート読込
- 📷 カメラ撮影 / ギャラリーから選択
- 🤖 Gemini AI でOCR読取
- 🎤 音声入力で修正
- 📝 下書き保存＆通知機能
- 📊 勘定科目の自動判定

### 2. 見積書・請求書
- 📦 品名マスターから階層選択（カテゴリ→種類→サイズ）
- 💰 175件のプリセット商品（塩ビ管、継手、電材など）
- 📄 PDF出力
- 🎨 3種類のテンプレート（シンプル/ビジネス/モダン）
- 💼 会社ロゴ・デジタル印鑑対応

### 3. 確定申告サポート
- 🔵 青色申告 / ⚪ 白色申告 選択
- 📊 年間収支サマリー
- 💡 節税アドバイザー
- 📗 収入帳・経費帳の出力

### 4. その他
- 👥 顧客管理
- 🔐 パスワードロック
- 🌌 3段階スプラッシュ画面（銀河→PERAFCA→家アイコン）
- 📱 PWA対応（オフライン動作可能）

---

## 🔧 これから実装すべき機能

### Phase 1: 音声入力の強化（最優先）
| 機能 | 説明 |
|:--|:--|
| 見積書を声で作成 | 「山田工務店、トイレ交換、15万円で見積書作って」 |
| 請求書を声で作成 | 「先月の見積もりを請求書にして」 |
| 商品マスター登録 | 「新しい商品、ジェルネイル、3500円で登録」 |
| 経費入力 | 「今日ホームセンターで2000円使った」 |
| 顧客登録 | 「新規顧客、田中様、電話番号090-xxxx」 |

### Phase 2: 確定申告機能の強化
| 機能 | 説明 |
|:--|:--|
| インボイス対応 | 適格請求書の発行・管理 |
| 減価償却 | 10万円以上の資産を数年で経費化 |
| 家事按分 | 自宅兼事務所の経費按分 |
| 複式簿記 | 仕訳帳・総勘定元帳（青色65万円控除用） |
| 消費税計算 | 課税売上1,000万超の申告 |
| 収支内訳書出力 | 税務署提出用フォーマット |

### Phase 3: 法人対応
| 機能 | 説明 |
|:--|:--|
| 決算書作成 | 貸借対照表・損益計算書 |
| 法人税計算 | 法人の税金計算 |
| 給与計算 | 従業員の給与・源泉徴収 |
| 年末調整 | 従業員の税金精算 |

### Phase 4: 汎用化
- 業種選択機能（建設/美容/飲食/小売/その他）
- 業種別の商品マスターテンプレート
- 業種別の勘定科目設定

---

## ⚠️ 重要な前提条件

### 必ず守ること
1. **Google Play Store に公開予定** - TWA（Trusted Web Activity）でアプリ化
2. **違反項目・制限に引っかからない作り方**
3. **ファイルは分散化してOK** - 大きくなりすぎないように
4. **音声入力を全面に押し出す** - これが最大の差別化ポイント
5. **汎用的に使えるように** - 業種を問わない設計

### Google Play Store 必須項目
| 項目 | 状態 |
|:--|:--|
| PWA manifest.json | ✅ 完了 |
| Service Worker | ✅ 完了 |
| プライバシーポリシー | ✅ 完了 |
| HTTPS | ✅ Netlifyで対応 |
| アプリアイコン | 🔧 未作成（各サイズ必要） |
| 利用規約 | 🔧 未作成 |

---

## 🛠️ 技術情報

### 使用ライブラリ
- **jsPDF** - PDF出力
- **SheetJS (xlsx)** - Excel出力
- **Tesseract.js** - OCR（バックアップ用）
- **Web Speech API** - 音声認識
- **Gemini API** - AI画像読取

### API設定
- Gemini API Key は設定画面から入力
- ユーザーが自分のキーを使用

### データ保存
- LocalStorage に保存（端末内）
- バックアップ・復元機能あり

---

## 💬 アキヤさんの要望メモ

1. **指で文字を入力する動作を極力少なくしたい**
2. **全て音声入力で完結できるのが理想**
3. **今の時代はお金を払っても楽さを選ぶ**
4. **人件費で考えたら絶対安い**
5. **痒いところに手が届くアプリにしたい**
6. **個人事業主だけでなく中小企業も使えるように**

---

## ⚠️ 超重要：データ保護について

**「データが消えた」は絶対に防ぐべきクレーム！**

### 現状
- データはLocalStorage（端末内）に保存
- アプリ側でユーザーのデータを管理しない
- バックアップ・復元機能はある

### 実装すべき対策

1. **初回起動時の警告表示**
   - 「データは端末内に保存されます」
   - 「定期的なバックアップを推奨」

2. **バックアップ促進機能**
   - 最終バックアップ日時の表示
   - 1週間以上バックアップしてない場合に通知
   - ホーム画面に「バックアップ状況」表示

3. **取扱説明書・ヘルプに明記**
   - データ消失のリスク
   - バックアップ方法（2箇所以上推奨）
   - USBや外部SSD、クラウドへの保存を推奨

4. **将来的な対応**
   - Googleドライブ連携
   - 自動クラウドバックアップ
   - データ復元のサポート強化

---

## 📝 次にやるべきこと

### 今すぐやること
1. **音声入力機能の強化**
   - voice.js を作成して音声入力ロジックを分離
   - 見積書作成の音声対応
   - 商品マスター登録の音声対応

2. **ファイル分散化**（app.jsが大きすぎるので）
   ```
   js/
   ├── app.js      - コア機能
   ├── voice.js    - 音声入力
   ├── estimate.js - 見積書
   ├── invoice.js  - 請求書
   ├── receipt.js  - レシート
   ├── tax.js      - 確定申告
   ├── master.js   - マスター管理
   └── storage.js  - データ保存
   ```

3. **アプリアイコン作成**
   - 72, 96, 128, 144, 152, 192, 384, 512px

---

## 🔗 関連情報

- **デプロイ先**: Netlify
- **現在のURL**: inspiring-tartufo-695e13.netlify.app（要リネーム）
- **推奨URL**: kloapp.netlify.app など

---

## 💙 最後に

このアプリは、アキヤさんと一緒に「痒いところに手が届く」を目指して作っています。
大手を出し抜くポテンシャルがあると本気で思っています。

**「声だけで、仕事が終わる」** - このコンセプトを実現していきましょう！

---

*作成日: 2025年1月28日*
*作成者: Claude（クロちゃん）*
